<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Checklist Pague Menos</title>
    
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#004a99">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <link rel="apple-touch-icon" href="PagueMenosLogo.png">

    <style>
        :root { --primary: #004a99; --success: #28a745; --danger: #dc3545; --bg: #f4f7f9; }
        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
        body { font-family: 'Segoe UI', sans-serif; background: var(--bg); margin: 0; padding: 10px; display: flex; flex-direction: column; align-items: center; }
        .logo-fixa { position: fixed; top: 15px; left: 15px; width: 95px; opacity: 0.5; z-index: 1000; pointer-events: none; }
        .container { width: 100%; max-width: 550px; margin-top: 30px; }
        header { background: var(--primary); color: white; padding: 35px 20px; border-radius: 12px; margin-bottom: 20px; text-align: center; }
        .header-text h2 { margin: 0; font-size: 26px; text-transform: uppercase; }
        #btnInstalar { display: none; background: var(--success); color: white; width: 100%; padding: 18px; border-radius: 12px; border: none; font-weight: bold; margin-bottom: 20px; cursor: pointer; }
        .card { background: white; padding: 15px; border-radius: 12px; margin-bottom: 15px; border: 1px solid #e0e6ed; }
        label { font-weight: bold; font-size: 11px; color: #888; display: block; margin-top: 10px; text-transform: uppercase; }
        input { width: 100%; padding: 14px; margin: 6px 0; border: 1px solid #ccd6e0; border-radius: 8px; font-size: 16px; outline: none; }
        .section-title { font-weight: bold; color: var(--primary); background: #f0f4f8; padding: 12px; border-radius: 8px; margin-bottom: 10px; text-transform: uppercase; text-align: center; }
        .item { padding: 18px 10px; border-bottom: 1px solid #f1f1f1; }
        .btns { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; margin-top: 10px; }
        .btn { padding: 16px; border: 1px solid #ccd6e0; border-radius: 10px; background: #fff; font-weight: bold; cursor: pointer; }
        .active-yes { background: var(--success) !important; color: white; }
        .active-no { background: var(--danger) !important; color: white; }
        .btn-fin { width: 100%; padding: 20px; background: var(--primary); color: white; border: none; border-radius: 12px; font-weight: bold; font-size: 18px; margin: 25px 0; cursor: pointer; }
        #results { display: none; background: white; padding: 20px; border-radius: 12px; border: 2px solid var(--primary); margin-bottom: 30px; width: 100%; }
        pre { background: #fdfdfd; padding: 15px; white-space: pre-wrap; font-size: 13px; border: 1px solid #eee; border-radius: 8px; font-family: monospace; }
        #toast { position: fixed; top: 20px; background: #000; color: #fff; padding: 10px 20px; border-radius: 20px; display: none; z-index: 10000; }
        footer { margin: 20px 0 40px; text-align: center; color: #95a5a6; font-size: 12px; }
    </style>
</head>
<body>

<img src="PagueMenosLogo.png" class="logo-fixa" alt="Logo">
<div id="toast"></div>

<div class="container">
    <header>
        <div class="header-text">
            <h2>CHECK-LIST</h2>
            <p>CLIENTE OCULTO</p>
        </div>
    </header>

    <button id="btnInstalar" onclick="dispararInstalacao()">üì• INSTALAR APLICATIVO</button>
    
    <div class="card">
        <label>Colaborador Avaliado</label>
        <input type="text" id="nome" placeholder="Nome completo">
        <label>Matr√≠cula</label>
        <input type="tel" id="matri" placeholder="Ex: 000000">
    </div>

    <div id="checklist-area"></div>

    <button class="btn-fin" onclick="finalizar()">GERAR RELAT√ìRIO FINAL</button>

    <div id="results">
        <h3 id="score" style="text-align:center; color: var(--primary);"></h3>
        <pre id="relatorio"></pre>
        <button class="btn-fin" style="background:#4a5568;" onclick="copiar()">COPIAR PARA WHATSAPP</button>
    </div>

    <footer>
        Desenvolvido por <strong>Erik Henrique - 126841</strong><br>
        Sistema n√£o oficial para suporte √† gest√£o.
    </footer>
</div>

<script>
    var perguntas = {
        'SAL√ÉO': ['Abordou cliente no sal√£o?', 'Atendimento sem espera?', 'Apresentou-se pelo nome?', 'Cordialidade?', 'Entendeu a necessidade?', 'Acompanhou at√© a se√ß√£o?'],
        'BALC√ÉO': ['Apresentou-se?', 'Pediu cadastro?', 'Atualizou cadastro?', 'Chamou pelo nome?', 'Vantagens e descontos?', 'Cupom DSM?', 'Fidelidade?', 'Medalha?', 'Clinicfarma?', 'Conhecimento t√©cnico?', 'Cordialidade?'],
        'CAIXA': ['Pediu CPF?', 'Atend√¥metro?', 'Destacou desconto?', 'Formas de pagamento?', 'Super Troco?', 'Cupom por e-mail?', 'Sem lentid√£o?', 'Frase finaliza√ß√£o?', 'Cordialidade?', 'Acompanhou at√© a sa√≠da?'],
        'EXTRAS': ['Sauda√ß√£o?', 'Produto Foco?', 'UVC?', 'Super Descontos?', 'Organizou Fila?']
    };

    var respostas = {};
    var deferredPrompt;

    function montarChecklist() {
        var area = document.getElementById('checklist-area');
        var html = '';
        for (var secao in perguntas) {
            html += '<div class="card"><div class="section-title">' + secao + '</div>';
            for (var i = 0; i < perguntas[secao].length; i++) {
                var p = perguntas[secao][i];
                var id = secao + '-' + i;
                html += '<div class="item">';
                html += '<div style="margin-bottom:10px; font-weight:500;">' + p + '</div>';
                html += '<div class="btns">';
                html += '<button class="btn" id="y-' + id + '" onclick="marcar(\'' + id + '\', 1)">SIM ‚úÖ</button>';
                html += '<button class="btn" id="n-' + id + '" onclick="marcar(\'' + id + '\', 0)">N√ÉO ‚ùå</button>';
                html += '</div></div>';
            }
            html += '</div>';
        }
        area.innerHTML = html;
    }

    function marcar(id, valor) {
        respostas[id] = valor;
        document.getElementById('y-' + id).className = (valor === 1) ? 'btn active-yes' : 'btn';
        document.getElementById('n-' + id).className = (valor === 0) ? 'btn active-no' : 'btn';
    }

    function finalizar() {
        var nome = document.getElementById('nome').value;
        var matri = document.getElementById('matri').value;
        if (!nome || !matri) { alert('Preencha os dados!'); return; }

        var acertos = 0;
        var total = 0;
        var rel = '*AVALIA√á√ÉO CLIENTE OCULTO*\nColaborador: ' + nome + '\nMatr√≠cula: ' + matri + '\n\n';

        for (var secao in perguntas) {
            rel += '\nüîπ *' + secao + '*';
            for (var i = 0; i < perguntas[secao].length; i++) {
                total++;
                var r = respostas[secao + '-' + i];
                if (r === 1) acertos++;
                rel += '\n' + (r === 1 ? '‚úÖ' : '‚ùå') + ' ' + perguntas[secao][i];
            }
        }

        var nota = ((acertos / total) * 100).toFixed(0);
        var textoFinal = rel + '\n\nüìä *NOTA FINAL: ' + nota + '%*\n_Gerado por Erik Henrique_';
        
        document.getElementById('relatorio').innerText = textoFinal;
        document.getElementById('score').innerText = 'NOTA: ' + nota + '%';
        document.getElementById('results').style.display = 'block';
        window.scrollTo(0, document.body.scrollHeight);
    }

    function copiar() {
        var texto = document.getElementById('relatorio').innerText;
        navigator.clipboard.writeText(texto).then(function() {
            var t = document.getElementById('toast');
            t.style.display = 'block'; t.innerText = 'Copiado!';
            setTimeout(function() { t.style.display = 'none'; }, 2000);
        });
    }

    window.addEventListener('beforeinstallprompt', function(e) {
        e.preventDefault();
        deferredPrompt = e;
        document.getElementById('btnInstalar').style.display = 'block';
    });

    function dispararInstalacao() {
        if (deferredPrompt) {
            deferredPrompt.prompt();
            deferredPrompt = null;
            document.getElementById('btnInstalar').style.display = 'none';
        }
    }

    if ('serviceWorker' in navigator) {
        navigator.serviceWorker.register('./sw.js');
    }

    window.onload = montarChecklist;
</script>
</body>
</html>
