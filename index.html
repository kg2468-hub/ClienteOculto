<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Checklist Pague Menos</title>
    
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#004a99">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <link rel="apple-touch-icon" href="PagueMenosLogo.png">

    <style>
        :root { --primary: #004a99; --success: #28a745; --danger: #dc3545; --bg: #f4f7f9; }
        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
        body { font-family: 'Segoe UI', sans-serif; background: var(--bg); margin: 0; padding: 10px; display: flex; flex-direction: column; align-items: center; }
        .logo-fixa { position: fixed; top: 15px; left: 15px; width: 95px; opacity: 0.5; z-index: 1000; pointer-events: none; }
        .container { width: 100%; max-width: 550px; margin-top: 30px; }
        header { background: var(--primary); color: white; padding: 35px 20px; border-radius: 12px; margin-bottom: 20px; text-align: center; }
        .header-text h2 { margin: 0; font-size: 26px; text-transform: uppercase; }
        #btnInstalar { display: none; background: var(--success); color: white; width: 100%; padding: 18px; border-radius: 12px; border: none; font-weight: bold; margin-bottom: 20px; }
        .card { background: white; padding: 15px; border-radius: 12px; margin-bottom: 15px; border: 1px solid #e0e6ed; }
        label { font-weight: bold; font-size: 11px; color: #888; display: block; margin-top: 10px; text-transform: uppercase; }
        input { width: 100%; padding: 14px; margin: 6px 0; border: 1px solid #ccd6e0; border-radius: 8px; font-size: 16px; outline: none; }
        .section-title { font-weight: bold; color: var(--primary); background: #f0f4f8; padding: 12px; border-radius: 8px; margin-bottom: 10px; text-transform: uppercase; text-align: center; }
        .item { padding: 18px 10px; border-bottom: 1px solid #f1f1f1; }
        .btns { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; margin-top: 10px; }
        .btn { padding: 16px; border: 1px solid #ccd6e0; border-radius: 10px; background: #fff; font-weight: bold; cursor: pointer; }
        .active-yes { background: var(--success) !important; color: white; }
        .active-no { background: var(--danger) !important; color: white; }
        .btn-fin { width: 100%; padding: 20px; background: var(--primary); color: white; border: none; border-radius: 12px; font-weight: bold; font-size: 18px; margin: 25px 0; }
        #results { display: none; background: white; padding: 20px; border-radius: 12px; border: 2px solid var(--primary); margin-bottom: 30px; }
        pre { background: #fdfdfd; padding: 15px; white-space: pre-wrap; font-size: 13px; border: 1px solid #eee; border-radius: 8px; }
        #toast { position: fixed; top: 20px; background: #000; color: #fff; padding: 10px 20px; border-radius: 20px; display: none; z-index: 10000; }
        .modal-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.6); display: none; align-items: center; justify-content: center; z-index: 20000; padding: 20px; }
        .modal-content { background: white; padding: 25px; border-radius: 15px; width: 100%; max-width: 400px; text-align: center; }
    </style>
</head>
<body>

<img src="PagueMenosLogo.png" class="logo-fixa" alt="Logo">

<div id="toast"></div>

<div class="container">
    <header>
        <div class="header-text">
            <h2>CHECK-LIST</h2>
            <p>CLIENTE OCULTO</p>
        </div>
    </header>

    <button id="btnInstalar" onclick="dispararInstalacao()">ðŸ“¥ INSTALAR APLICATIVO</button>
    
    <div class="card">
        <label>Colaborador Avaliado</label>
        <input type="text" id="nome" placeholder="Nome completo">
        <label>MatrÃ­cula</label>
        <input type="tel" id="matri" placeholder="Ex: 000000">
    </div>

    <div id="checklist-area"></div>

    <button class="btn-fin" onclick="finalizar()">GERAR RELATÃ“RIO FINAL</button>

    <div id="results">
        <h3 id="score" style="text-align:center;"></h3>
        <pre id="relatorio"></pre>
        <button class="btn-fin" style="background:#4a5568;" onclick="copiar()">COPIAR PARA WHATSAPP</button>
    </div>
</div>

<script>
    const perguntas = {
        "SALÃƒO": ["Abordou cliente no salÃ£o?", "Atendimento sem espera?", "Apresentou-se pelo nome?", "Cordialidade?", "Entendeu a necessidade?", "Acompanhou atÃ© a seÃ§Ã£o?"],
        "BALCÃƒO": ["Apresentou-se?", "Pediu cadastro?", "Atualizou cadastro?", "Chamou pelo nome?", "Vantagens e descontos?", "Cupom DSM?", "Fidelidade?", "Medalha?", "Clinicfarma?", "Conhecimento tÃ©cnico?", "Atencioso?"],
        "CAIXA": ["Pediu CPF?", "AtendÃ´metro?", "Destacou desconto?", "Formas de pagamento?", "Super Troco?", "Cupom por e-mail?", "LentidÃ£o?", "Frase de finalizaÃ§Ã£o?", "Cordialidade?", "Acompanhou atÃ© a saÃ­da?"],
        "EXTRAS": ["SaudaÃ§Ã£o?", "Produto Foco?", "UVC?", "Super Descontos?", "Fila?"]
    };

    let respostas = {};
    let deferredPrompt;

    window.onload = () => {
        const area = document.getElementById('checklist-area');
        let html = '';
        for (let secao in perguntas) {
            html += `<div class="card"><div class="section-title">${secao}</div>`;
            perguntas[secao].forEach((p, i) => {
                const id = `${secao}-${i}`;
                html += `<div class="item">
                    <div style="margin-bottom:10px">${p}</div>
                    <div class="btns">
                        <button class="btn" id="y-${id}" onclick="marcar('${id}', 1)">SIM</button>
                        <button class="btn" id="n-${id}" onclick="marcar('${id}', 0)">NÃƒO</button>
                    </div>
                </div>`;
            });
            html += `</div>`;
        }
        area.innerHTML = html;

        if ('serviceWorker' in navigator) {
            navigator.serviceWorker.register('./sw.js');
        }
    };

    window.addEventListener('beforeinstallprompt', (e) => {
        e.preventDefault();
        deferredPrompt = e;
        document.getElementById('btnInstalar').style.display = 'block';
    });

    async function dispararInstalacao() {
        if (deferredPrompt) {
            deferredPrompt.prompt();
            deferredPrompt = null;
            document.getElementById('btnInstalar').style.display = 'none';
        }
    }

    function marcar(id, valor) {
        respostas[id] = valor;
        document.getElementById(`y-${id}`).className = "btn " + (valor === 1 ? "active-yes" : "");
        document.getElementById(`n-${id}`).className = "btn " + (valor === 0 ? "active-no" : "");
    }

    function finalizar() {
        const nome = document.getElementById('nome').value;
        const matri = document.getElementById('matri').value;
        if (!nome || !matri) { alert("Preencha os dados!"); return; }

        let acertos = 0;
        let total = Object.values(perguntas).flat().length;
        let rel = `*CHECKLIST PAGUE MENOS*\nColaborador: ${nome}\nMatrÃ­cula: ${matri}\n\n`;

        for (let secao in perguntas) {
            rel += `\n*${secao}*`;
            perguntas[secao].forEach((p, i) => {
                const r = respostas[`${secao}-${i}`];
                if (r === 1) acertos++;
                rel += `\n${r === 1 ? 'âœ…' : 'âŒ'} ${p}`;
            });
        }

        const nota = ((acertos / total) * 100).toFixed(0);
        document.getElementById('relatorio').innerText = rel + `\n\nðŸ“Š NOTA: ${nota}%`;
        document.getElementById('score').innerText = `NOTA: ${nota}%`;
        document.getElementById('results').style.display = 'block';
        window.scrollTo(0, document.body.scrollHeight);
    }

    function copiar() {
        navigator.clipboard.writeText(document.getElementById('relatorio').innerText);
        const t = document.getElementById('toast');
        t.style.display = "block"; t.innerText = "Copiado!";
        setTimeout(() => t.style.display = "none", 2000);
    }
</script>
</body>
</html>

